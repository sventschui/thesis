\section{Fallbeispiel AXA Gesundheitsvorsorge}

In diesem Kapitel wird die Anwendbarkeit der künstlichen Intelligenz zur automatisierten Verarbeitung von eingereichten Rechnungen bei der AXA Gesundheitsvorsorge überprüft.

Es wird erst ein Überblick über den Prozess gewährt, aus welchem anschliessend Aufgaben abgeleitet werden, welche mit Hilfe von künstlicher Intelligenz automatisiert werden sollen.

\subsection{Einleitung}

\todo[inline]{Grober Abriss über den Umfang des Prototypen

Umfang reduzieren auf 2 Teilaspekte:

- Rechnungsklassifizierung (hierzu 2 Ansätze (Pixel vs. OCR) vergleichen)

- Informationsextraktion (e.g. von Patienten namen und des Totalbetrags)
}

Der Prozess der Rechnungseinreichung und -verarbeitung (vgl. Abbildung \ref{prozessaxa}) der AXA kann aufgrund zwei verschiedener Ereignisse angestossen werden. In jedem Fall reicht der Kunde eine Rechnung ein. Dies kann er entweder digital, im Kundenportal, oder per Post machen. 

\begin{figure}[h]
    \captionsetup{width=.8\linewidth}
    \caption{Rechnungseinreichungsprozess der AXA Gesundheitsvorsorge. Vom Kunden per Post oder über das Kundenportal eingereichte Rechnungen durchlaufen mehrere Prozessschritte in Verantwortung unterschiedlicher Organisationen.}
    \label{prozessaxa}
    \centering
    \vspace{0.2cm}
    \includegraphics[width=\textwidth]{graphics/rechnungseinreichung-bpmn.png}\\
    \vspace{0.3cm}
    \caption*{Quelle: TODO: Eigene Darstellung}
\end{figure}

\todo[inline]{Optimierung Grafik

Kundenportal löschen

Labels der Linien besser umbrechen

Linien mit Pfeilen

Auszahlung -> Rückmeldung an Kunde (Auszahlung oder Rückweisung)

Eventuelle Rückfragen und frühzeitige Abweisungen (QG) aufzeigen

OKP weiterleitung

Nur den Schritt "Indexierung" einfärben

--> See new Download}

Im Kundenportal hat der Kunde die Möglichkeit eine Rechnung hochzuladen. Dabei kann er entweder ein Dokument auf seinem Endgerät wählen oder die Kamera seines Geräts nutzen, um eine Rechnung zu fotografieren.

Nach erfolgreichem Hochladen der Rechnung im Kundenportal durchläuft diese eine erste manuelle Qualitätsprüfung. Diese Qualitätsprüfung wurde eingeführt, da hochgeladene Rechnung teilweise ungenügende Qualität vorweisen. Entspricht die Rechnung nicht den Qualitätsanforderungen oder fehlt eine Seite oder eine ärztliche Verordnung, so wird der Kunde gebeten, die vollständige Rechnung erneut hochzuladen.

Nach erfolgreicher Qualitätsprüfung wird die Rechnung an den Scanning und Indexierungsdienstleister der AXA weitergeleitet.

Entscheidet sich der Kunde für die Einreichung per Post, so wird sein Brief direkt an den Scanning und Indexierungsdienstleister der AXA weitergeleitet, bei welchem die Rechnung eingescannt wird.

Nach beiden dieser Einstiegspunkten in den Prozess indexiert nun der Scanning und Indexierungsdienstleister der AXA die eingereichte Rechnung. Dieser Aufgabenschritt erfolgt teilweise automatisiert und teilweise manuell. Wie genau die Indexierung abläuft ist nicht bekannt, da diese Dienstleistung eingekauft wird.

Nach der Indexierung werden die Scans sowie das strukturierte Resultat der Indexierung elektronisch an das Kernsystem der AXA Gesundheitsvorsorge übermittelt. Dieses Kernsystem verarbeitet die eingegangenen Rechnungen aufgrund eines Regelwerks. Kann die Rechnung nicht verarbeitet werden, weil diese nicht korrekt Indexiert wurde oder Informationen fehlen, muss eine FachspezialistIn eingreiffen. Nach allfälligen Rückfragen und Korrekturen durch die FachspezialistIn wird die Rechnung verarbeitet. 

Nach der Erfolgreichen Verarbeitung der Rechnung wird der Kunde elektronisch informiert, ob die beanspruchten Leistungen versichert sind und ob eine Rückvergütung ausbezahlt wird.

Hat der Kunde die AXA bevollmächtigt, so wird die Rechnung in gewissen Fällen, je nach Rechnungspositionen, automatisiert an die Grundversicherung des Kunden weitergeleitet. 

Ziel der AXA Gesundheitsvorsorge ist es, diesen Prozess für eingereichte Rechnungen, welche Fitnesscenter und Optiker betreffen, vollständig zu automatisieren. Dabei gibt es in diversen Bereichen Herausforderungen, welche aktuell angegangen werden. Diese Arbeit hat zum Ziel, die Herausforderungen im Bereich der Indexierung anzugehen. Es wird untersucht, ob die Anwendung künstlicher Intelligenz eine Automatisierung der Indexierung ermöglichen kann.

Mit Hilfe der Erkenntnisse 

% Um den Umfang dieser Analyse einzugrenzen, wird der Fokus auf Rechnungen von Optikern, Fitnesscentern und Sportvereinen gelegt. Diese Rechnungen machen 23\% der eingereichten Rechnungen aus und sind Versicherungstechnisch relativ einfach handzuhaben.

% optiker 2660 -> 
% fitness 2055
% sportsclub 847
% =subtotla 5562
% other 18881
% =total 24443


\subsection{Vorgehen und Methodik}

\todo[inline]{Abschnitt überarbeiten...}

Die Anwendbarkeit der künstlichen Intelligenz für dieses Fallbeispiel wird durch zwei praktische Experimente geprüft. Dafür werden zuerst die Anforderungen und Bewertungskriterien an die Indexierung gesammelt und anschliessend Teilaufgaben abgeleitet. 

Für jede Teilaufgabe werden Messkriterien definiert, welche die Grundlagen für die Bewertung der Gesamtaufgabe bilden. Es wird für jede Teilaufgabe mindestens ein Experiment durchgeführt.

Für jedes Experiment wird eine aufgabenspezifische künstliche Intelligenz geschaffen, welche anhand der für die Teilaufgabe definierten Messkriterien bewertet wird.

\subsection{Anforderungen}

Um Rechnungen von Fitnesscenter und Optikern automatisiert verarbeiten zu können, müssen diese Rechnungen erkannt und die notwendigen Informationen, welche nachfolgend genauer spezifiziert werden, extrahiert werden.

Um eine Rechnung eines Optikers zu verarbeiten, sind folgende Informationen relevant:

\begin{itemize}
    \item \textbf{Leistungsbezüger}
    
    Es muss ermittelt werden, für wen die Rechnung ausgestellt wurde. Anhand dieser Information wird geprüft, ob und wie diese Person bei der AXA versichert ist. Auch wird damit geprüft, dass der maximal versicherte Betrag noch nicht ausgeschöpft ist.
    
    Ist der Leistungsbezüger minderjährig, so wird ein gewisser Betrag von der Grundversicherung übernommen. In diesem Fall wird dieser Betrag von der Rückvergütung der AXA abgezogen und die Rechnung an die Grundversicherung weitergeleitet.
    
    \item \textbf{Totalbetrag der Rechnung (inkl. Währung)}
    
    Dieser Betrag bildet die Grundlage zur Berechnung der geschuldeten Leistung an den Kunden. 
    
    Einzelne Rechnungspositionen sind für Rechnungen von Optikern nicht relevant.
    
    \item \textbf{Hinweis auf eine ärztliche Verordnung}
    
    Besteht eine ärztliche Verordnung, ist ein gewisser Betrag bei der Grundversicherung versichert. In diesem Fall wird dieser Betrag von der Rückvergütung der AXA abgezogen und die Rechnung an die Grundversicherung weitergeleitet.
\end{itemize}

%\paragraph{
%    \textbf{Relevante Attribute einer Rechnung für einen Sportverein}
%}

%Eine Rechnung eines Sportvereins wird bei der AXA Anhand folgender Attribute beurteilt:

%\begin{itemize}
%    \item \textbf{Leistungsbezüger}
%    
%    Es muss ermittelt werden, für wen die Rechnung ausgestellt wurde. Anhand dieser Information wird geprüft ob und wie diese Person bei der AXA Versichert ist. Auch wird damit geprüft, dass der maximal versicherte Betrag noch nicht ausgeschöpft ist.
%    \item \textbf{Totalbetrag der Rechnung (inkl. Währung):}
%    
%    Dieser Betrag bildet die Grundlage zur Berechung des geschuldeten Betrages. 
%    
%    Einzelne Rechnungspoisition sind für Rechnungen eines Sportvereins nicht relevant.
%    \item \textbf{Sportart}
%    
%    Die AXA anerkennt alle olympischen Sportarten. Das bedeutet, gewisse Sportarten sind nicht versichert. Es muss also die Sportart ermittelt werden, um die Versicherungsdeckung zu prüfen.
%\end{itemize}

Folgende Informationen sind relevant, um eine Rechnung für ein Fitness-Abo zu verarbeiten:

\begin{itemize}
    \item \textbf{Leistungsbezüger}
    
    Es muss ermittelt werden, für wen die Rechnung ausgestellt wurde. Anhand dieser Information wird geprüft ob und wie diese Person bei der AXA versichert ist. Auch wird damit geprüft, dass der maximal versicherte Betrag noch nicht ausgeschöpft ist.
    \item \textbf{Totalbetrag der Rechnung (inkl. Währung):}
    
    Dieser Betrag bildet die Grundlage zur Berechnung der geschuldeten Leistung an den Kunden. 
    
    Einzelne Rechnungspositionen sind für Rechnungen von Optikern nicht relevant.
    \item \textbf{Fitnesscenter (Leistungserbringer)}
    
    Die AXA anerkennt alle Fitnesscenter mit dem Label Qualitop von Qualicert oder mit einer Bewertung von mindestens 3 Sternen bei Fitnessguide.
\end{itemize}

Anahnd dieser Informationen können Rechnungen automatisiert verarbeitet werden. Es ist wichtig, dass diese Informationen korrekt extrahiert werden. Durch die Automatisierung entfällt jegliche manuelle Prüfung und Fehler würden, wenn überhaupt, erst dem Kunden auffallen. 

\todo[inline]{Hier definieren:

- Wieviel \% der Fitness und Optiker Rechnungen sollen automatisiert verarbeitet werden

- Wie viele Fehler dürfen gemacht werden (Falsche klassifiziert, falsche Beträge, falsche Leistungsbezüger)

- ... andere Metriken}

\subsection{Architektur - TODO: bessere Überschrift}

Wie in den Anforderungen bereits ersichtlich, besteht die Aufgabe aus zwei Teilschritten. Als erstes 

Um die Aufgabenstellung besser zu verstehen und Schrittweise bearbeiten zu können, wird diese in zwei Teilaufgaben unterteilt. 

Im ersten Schritt werden Rechnungen klassifiziert, damit Rechnungen von Optikern und Fitnesscentern zur weiteren Verarbeitung ausgelenkt werden können. 

Im zweiten Schritt werden die notwendigen Informationen aus den Rechnungen extrahiert. Die Klassifizierung aus dem ersten Schritt erlaubt es, in diesem Schritt ein System zu verwenden, welches auf eine Klasse von Rechnungen spezialisiert ist. 

\subsection{Teil 1 - Klassifizierung von Rechnungen}

Die Klassifizierung dient dazu, eine Rechnung einer bestimmten Art (Klasse) zuzuweisen. Die Klassen \enquote{Optiker} und \enquote{Fitness} sind durch die Anforderungen gegeben. Neben diesen Klassen könnten Rechnungen noch in viele weitere Klassen eingeteilt werden. Um dem Rechnung zu tragen, werden in diesem Experiment  Rechnungen den Klassen \enquote{Optiker}, \enquote{Fitness}, \enquote{Sportverein} und \enquote{Übrige} zugewiesen. In der späteren Anwendung wäre es denkbar, die Anzahl Klassen zu erhöhen und somit auch andere Arten von Rechnungen zu Automatisieren.

Als Ausgangspunkt für die Klassifizierung steht ein Bild einer Rechnung. Die Klassifizierung von Bildern respektive Fotos ist eine Kernproblematik der Computer Vision und bildet in diesem Bereich die Grundlage für viele weitere Problematiken~\autocite{http://cs231n.github.io/classification/}. 

% Die Wichtigkeit der Bildklassifizierung zeigt die Organisation ImageNet. ImageNet aht es zum Ziel, Forschern einen einfachen Zugang zu Datensätzen von Bildern zu gewähren. Seit 2010 wurden bereits sieben Wettbewerbe im Bereich der Computer Vision veranstaltet rund um die Klassifikation von Bildern und die Erkennung von Objekten auf diesen Bildern~\autocite{ImageNet2019}. 

Es liegt nahe, die Klassifizierung der Rechnungen mit Bild-basierten Modellen anzugehen. Im folgenden Kapitel wird dieser Ansatz verfolgt.

Nicht nur im Bereich der Computer Vision ist das Thema der Klassifikation ein viel behandeltes. Im Bereich des Natural Language Processing ist die Klassifikation von Wörtern, Sätzen oder ganzen Texten eine bekannte Problemstellung. Die sogenannte Text Classification ist die Grundlage für viele Applikationen, welche mit Texten arbeiten. So verwenden beispielsweise Mail-Server Text Classification um zu entscheiden, ob ein E-Mail Spam ist oder nicht~\autocite{https://developers.google.com/machine-learning/guides/text-classification/}

Im Kapitel \autoref{chap:text-based-classification} wird die Text-basierte Klassifizierung der Rechnungen weiter verfolgt.

Die beiden Vorgehen zur Klassifizierung werden anhand der knapp 24500 bereits bei der AXA eingereichten Rechnungen getestet. Um dies zu ermöglichen, wurden die Rechnungen aus dem System der AXA exportiert und in die oben genannten Klassen eingeteilt. Dabei wurde der Datensatz auf 17210 Rechnungen reduziert. Etwas mehr als 7000 Rechnungen hatten mehr als eine Seite. Aus diesem Grund konnten diese Rechnungen mit den vorhandenen Informationen nicht eindeutig einer Klasse zugewiesen werden. Eine manuelle Klassifizierung würde für den Umfang dieses Experiments einen zu grossen Arbeitsaufwand darstellen.

Die 17210 Rechnungen weisen eine sehr unregelmässige Verteilung auf die vier Klassen auf (vgl. Abbildung. \ref{class-distribution}). Würde während dem Training eines Modells diesem Umstand nicht Rechnung getragen werden, so würde das Modell die Klasse \enquote{Andere} stark bevorzugen. Während dem Training muss die Funktion, welche das Modell trainiert, die loss function, diesem Umstand Rechnung tragen~\autocite{TODO TODO TODO}.

\todo[inline]{Hier wäre evtl. ein einizelne horizontale stacked bar intelligenter...}

\begin{figure}[h]
    \captionsetup{width=.8\linewidth}
    \caption{TODO}
    \label{class-distribution}
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            ybar,
        	ylabel=Anzahl Rechnungen,
        	enlargelimits=0.05,
            symbolic x coords={Sportverein,Fitness,Optiker,Andere},
            xtick=data,
            nodes near coords,
            nodes near coords align={vertical},
        ]
            \addplot 
        	    coordinates {(Sportverein, 681) (Fitness, 1432) (Optiker, 2215) (Andere, 12995)};
        \end{axis}
    \end{tikzpicture}
    \caption*{Quelle: TODO: Eigene Darstellung}
\end{figure}

\subsubsection{Bild-basierte Rechnungsklassifizierung}

% http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.414.9846&rep=rep1&type=pdf

Analog der Klassifizierung von Objekten auf Fotos, wie dies von diversen künstlichen Intelligenzen gemacht wird, ist es auch denkbar, Rechnung mit Hilfe diesem Bild-basiertem Vorgehen zu klassifizieren.

Auf dem Machine Learning Blog \enquote{Towards Data Science} beschreiben und vergleichen diverse Autoren verschiedenste Modelle im Bereich der Computer Vision. Der Blog bietet einen guten Überblick über die aktuellen Methoden zur Klassifizierung von Bildern. So werden im Juli 2017 die Residual Networks (kurz ResNet), entwickelt von \textcite{He2015}, als die bahnbrechendse Eingabe bei der ImageNet Large Scale Visiual Recognition Competition\footnote{Die ImageNet Large Scale Visiual Recognition Competition ist ein Wettbewerb der ImageNet Organisation, bei welcher hunderte Data Scientists ihre Modelle im Bereich der Computer Vision vergleichen. TODO: Quelle} der letzten Jahre bezeichnet~\autocite{Fungg2017ResNet}. Im September 2018 beschreibt \textcite{SHTsuang2018Inception} das InceptionV4 Netzwerk von Google, welches vom GoogLeNet abgeleitet und mit den Ideen aus dem ResNet erweitert wurde. Das Modell erzielt noch bessere Resultate als das ResNet selbst. Im gleichen Artikel wird auch das Inception-ResNet-V2 vorgestellt, welches im Vergleich zum InceptionV4 Netzwerk schneller trainiert werden kann und zugleich etwas bessere Resultate erzielt. 

In einem Blog Post auf dem Google AI Blog präsentieren Forscher aus dem Google Brain Team das NASNet. NASNet ist ein Modell zur Klassifizierung von Bildern, welches durch die Anwendung von Machine Learning designed wurde~\autocite{GoogleNasNet}. Unter dem Codename AutoML publiziert das Google Brain Team einen Ansatz, bei welchem ein Neuronales Netzwerk ein anderes erstellt - eine künstliche Intelligenz, welche eine neue künstliche Intelligenz schafft. Mit diesem Ansatz kann das sehr aufwendige Design eines Neuronalen Netzwerks vereinfacht beziehungsweise automatisiert werden~\autocite{GoogleAutoML}.

Als Teil des selben Blog Posts, in welchem das NASNet präsentiert wird, vergleichen die Forscher von Google das Modell mit anderen Netzwerken, wie dem ResNet und dem Inception-ResNet-V2. Der Abbildung \ref{nasnet-comparision} ist zu entnehmen, dass das vom Google Brain Team präsentierte NASNet trotz reduzierter Anzahl an benötigter Operationen, sprich reduzierter Komplexität, verbesserte Genauigkeit als die bisherigen Netzwerke erzielt~\autocite{GoogleNasNet}.

\begin{wrapfigure}{r}{0.7\textwidth} 
    \caption{Vergleich des vom Google Brain Team präsentierten NASNet mit bestehenden Netzwerken zur Klassifizierung von Bildern des ImageNet Datensatzes. Es wird die Genauigkeit, der Prozentsatz richtig Klassifizierter Bilder der Gesamtheit aller Bilder, der Anzahl benötigter Operationen, sprich die Komplexität des Netzwerks, gegenübergestellt.}
    \label{nasnet-comparision}
    \centering
    \includegraphics[width=0.48\textwidth]{graphics/nasnet-comparision.jpg}
    \caption*{Quelle: \textcite{GoogleNasNet}}
\end{wrapfigure}

% ResNet Arxiv: https://arxiv.org/abs/1512.03385
% ResNet: https://towardsdatascience.com/an-overview-of-resnet-and-its-variants-5281e2f56035
% DRM Arxiv: https://arxiv.org/abs/1512.03385
% DRN: https://towardsdatascience.com/review-drn-dilated-residual-networks-image-classification-semantic-segmentation-d527e1a8fb5
% InceptionV4: https://towardsdatascience.com/review-inception-v4-evolved-from-googlenet-merged-with-resnet-idea-image-classification-5e8c339d18bc

% NASNet: https://ai.googleblog.com/2017/11/automl-for-large-scale-image.html

% NASNet example https://www.tensorflow.org/hub/tutorials/image_retraining

% AutoML: https://ai.googleblog.com/2017/05/using-machine-learning-to-explore.html


% TODO: Dilated Residual Network beschreiben: Veränderung der Convolutions in einem ResNet zu einem Grid anstelle der herkömmlichen convolution.

Im folgenden wird das ResNet, das Inception-ResNet-V2 sowie das NASNet Netzwerk angewendet, um die bisher bei der AXA eingereichten Rechnung zu klassifizieren.

Um Bilderkennungsmodelle mit Millionen von Parametern zu trainieren, werden viele Trainingsdaten und eine enorme Kapazität an Rechenleistung benötigt. Das Konzept des Transfer Learning bietet eine Möglichkeit, diese beiden Problematiken zu Umgehen und dabei nur wenig Genauigkeit einzubüssen. Beim Transfer Learning wird ein Modell mit Hilfe eines Datensatzes trainiert, welche nichts mit der eigentlichen Problemstellung zu tun hat. Das trainierte Modell wird dann mit den für die Problemstellung relevanten Daten weiter trainiert, sogenanntes Fine Tuning~\autocite{TensorflowImageRetraining, TDSTransferLearning}.

Um die Rechnungen zu klassifizieren wird Transfer Learning angewendet, indem das Training der genannten Modelle auf dem ImageNet Datensatz als Grundlage verwendet wird. 
% TODO: use keras and same classifier for NASNet: https://www.tensorflow.org/tutorials/images/hub_with_keras
Das ResNet und das Inception-ResNet-V2 wird auf die Schichten reduziert, bei welchen als Resultat ein Feature Vector entsteht. Das Klassifizierungsmodell wird durch ein Netzwerk mit zwei Convolution Schichten ersetzt. Bei diesem Klassifizierungsmodell wird mit zusätzlichen Dropout Schichten sowie einem dialting experimentiert.

\todo[inline]{Dropout und dilating beschreiben}

Für die Klassifizierung mit dem NASNet kommt eine open source Implementierung von tensorflow (Google) zur Anwendung. Auch 

TODO: ResNet50, ResNet101, InceptionV4 und DRN zur Rechnungsklassifikation vergleichen


TODO: Vermutung: Je mehr Klassen, desto ungenauer wird das wohl, da die anderen Klassen sehr ähnlich sein werden.

\subsubsection{Text-basierte Rechnungsklassifizierung}
\label{chap:text-based-classification}

- OCR error Problematik -> grammar check vorschlag

\todo[inline]{
Klassifizierung von Rechnungen

Evtl. verschiedene Ansätze

- OCR -> (SpellCorrection ->) WordEmbedding -> classification

- Pixel -> classification

- OCR -> (SpellCorrection ->) InformationExtraction -> classification

Bewertung der Ergebnisse
}

\subsection{Teil 2 - Informationsextraktion}

% Massive comparision of object detection models: https://medium.com/@jonathan_hui/object-detection-speed-and-accuracy-comparison-faster-r-cnn-r-fcn-ssd-and-yolo-5425656ae359
% Do these results hold true for our "special" case of papaer region detection?

% https://rectlabel.com

\subsection{Ausblick}

Mägliches Potential

